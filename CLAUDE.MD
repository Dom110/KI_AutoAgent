

---

## ğŸ—ï¸ SYSTEM-ARCHITEKTUR (v5.8.0+)

### **WICHTIG: Backend ist GLOBAL installiert!**

```
$HOME/.ki_autoagent/                # Globale Agent-Service Installation
â”œâ”€â”€ backend/                        # Python Backend (Agents, LangGraph)
â”‚   â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ langgraph_system/
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ config/                         # Globale Konfiguration
â”‚   â”œâ”€â”€ .env                        # API Keys (OpenAI, Anthropic, etc.)
â”‚   â”œâ”€â”€ instructions/               # â­ AGENT BASIS-INSTRUCTIONS
â”‚   â”‚   â”œâ”€â”€ architect-v2-instructions.md
â”‚   â”‚   â”œâ”€â”€ codesmith-v2-instructions.md
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ instructions_updates/       # Update Staging Area
â”‚       â”œâ”€â”€ v5.8.0/                 # Neue Version (fÃ¼r manuelles Merge)
â”‚       â””â”€â”€ backups/                # Backups vor Updates
â”‚
â”œâ”€â”€ data/                           # Agent-globale Daten
â”‚   â”œâ”€â”€ embeddings/                 # Vector Stores (Agent Memories)
â”‚   â””â”€â”€ knowledge_base/             # Agent Knowledge Base
â”‚
â”œâ”€â”€ venv/                           # Python Virtual Environment
â”œâ”€â”€ logs/                           # Globale Logs
â”œâ”€â”€ version.json                    # Installation Metadata
â””â”€â”€ {start.sh,stop.sh,status.sh}    # Convenience Scripts

/Users/.../KI_AutoAgent/            # Development Repo (optional)
â”œâ”€â”€ backend/                        # Backend Source Code
â”œâ”€â”€ vscode-extension/               # VS Code Extension Source
â”œâ”€â”€ install.sh                      # Installation Script
â””â”€â”€ update.sh                       # Update Script

/Users/.../MyApp/                   # USER WORKSPACE
â”œâ”€â”€ src/                            # User Code
â””â”€â”€ .ki_autoagent_ws/               # â­ WORKSPACE-SPEZIFISCHE DATEN
    â”œâ”€â”€ instructions/               # ğŸ“ Projekt-spezifische Instructions
    â”‚   â””â”€â”€ architect-custom.md     # "In diesem Projekt: NestJS, TypeORM..."
    â”œâ”€â”€ cache/                      # Workspace Cache (DB, File Hashes)
    â”œâ”€â”€ memory/                     # Agent Memories fÃ¼r dieses Projekt
    â””â”€â”€ artifacts/                  # Generierte Outputs
```

### **Wie es funktioniert:**

#### 1. **Installation**
```bash
# Einmalig: Backend als globaler Service installieren
cd /path/to/KI_AutoAgent
./install.sh

# Installiert nach: $HOME/.ki_autoagent/
# Erstellt: start.sh, stop.sh, status.sh
```

#### 2. **Backend Starten**
```bash
# Als Service (alle Workspaces)
$HOME/.ki_autoagent/start.sh [/path/to/workspace]

# VS Code Extension startet automatisch mit KI_WORKSPACE_PATH
```

#### 3. **Two-Tier Instruction System**
```python
# Agent lÃ¤dt Instructions in 2 Ebenen:

# 1. BASE INSTRUCTIONS (Required)
#    $HOME/.ki_autoagent/config/instructions/architect-v2-instructions.md
#    â†’ Agent-IdentitÃ¤t, Core Capabilities, Basis-Verhalten

# 2. PROJECT INSTRUCTIONS (Optional)
#    $WORKSPACE/.ki_autoagent_ws/instructions/architect-custom.md
#    â†’ "Verwende NestJS", "Code-Style", Projekt-Regeln

# Merge: Base + Project
```

#### 4. **Instructions Updates**
```bash
# Interaktiv (zeigt Diff, fragt fÃ¼r jede Datei)
./update.sh --instructions interactive

# Automatisch (Ã¼berschreibt alle)
./update.sh --instructions overwrite

# Preserve (behÃ¤lt existierende, installiert nur neue)
./update.sh --instructions preserve

# Backup (speichert neue in Staging Area)
./update.sh --instructions backup
```

### **Key Principles:**

1. **Agent Service** â†’ LÃ¤uft von `$HOME/.ki_autoagent/backend/`
2. **Workspace Separation** â†’ Analysiert NUR `$KI_WORKSPACE_PATH`
3. **Base Instructions** â†’ Globale Agent-IdentitÃ¤t
4. **Project Instructions** â†’ Workspace-spezifische Regeln
5. **Cache Isolation** â†’ Jeder Workspace: `.ki_autoagent_ws/cache/`

### **Verzeichnisse:**
```
GLOBAL:     $HOME/.ki_autoagent/           (Agent Service)
WORKSPACE:  $WORKSPACE/.ki_autoagent_ws/   (Projekt-Daten)
LEGACY:     ~/.ki-autoagent/               (Backwards Compatibility)
```

---

## ğŸš¨ REMINDER: ARCHITEKTUR-REGELN BEACHTEN!

**Bei JEDER Ã„nderung am System:**
1. Agents â†’ Python Backend (`$HOME/.ki_autoagent/backend/`)
2. UI â†’ TypeScript (`vscode-extension/`)
3. AI Calls â†’ NUR Python Backend
4. Frontend â†’ NUR WebSocket zu Backend
5. **Workspace Analyse â†’ NUR `$KI_WORKSPACE_PATH`, NICHT Backend-Code!**
6. **Base Instructions â†’ `$HOME/.ki_autoagent/config/instructions/`**
7. **Project Instructions â†’ `$WORKSPACE/.ki_autoagent_ws/instructions/`**

**VerstÃ¶ÃŸe gegen diese Regeln fÃ¼hren zu Duplikation und Chaos!**

---
